{% extends "base.html" %}

{% block title %}Mitglieder-Verwaltung - Admin{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>👥 Mitglieder-Verwaltung</h1>
        <p class="page-subtitle">Verwalte alle Gourmen-Mitglieder und deren Daten</p>
        <div class="page-actions">
            <a href="{{ url_for('admin.create_member') }}" class="btn btn-primary">➕ Neues Mitglied erstellen</a>
        </div>
    </div>
    
    <div class="page-content">
        
        <!-- Mitglieder-Liste als Cards (Mobile-First) -->
        <div class="members-grid">
            {% for member in members %}
            <div class="member-card {% if not member.is_active %}inactive{% endif %}">
                <div class="member-header">
                    <h3 class="member-name">{{ member.display_name }}</h3>
                    <div class="member-status">
                        {% if member.role.value == 'ADMIN' %}
                        <span class="badge badge-admin">ADMIN</span>
                        {% endif %}
                        {% if member.is_active %}
                        <span class="badge badge-active">Aktiv</span>
                        {% else %}
                        <span class="badge badge-inactive">Inaktiv</span>
                        {% endif %}
                        {% if member.vorstandsmitglied %}
                        <span class="badge badge-vorstand">Vorstand</span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="member-content">
                    <!-- Grunddaten -->
                    <div class="card card-secondary variant-info">
                        <div class="card-header">
                            <h3>👤 Grunddaten</h3>
                        </div>
                        <div class="card-body">
                        <p><strong>Name:</strong> {{ member.vorname }} {{ member.nachname }}</p>
                        {% if member.geburtsdatum %}
                        <p><strong>Geboren:</strong> {{ member.geburtsdatum.strftime('%d.%m.%Y') }}</p>
                        {% endif %}
                        {% if member.nationalitaet %}
                        <p><strong>Nationalität:</strong> {{ member.nationalitaet }}</p>
                        {% endif %}
                        </div>
                    </div>
                    
                    <!-- Kontakt -->
                    <div class="card card-secondary variant-success">
                        <div class="card-header">
                            <h3>📧 Kontakt</h3>
                        </div>
                        <div class="card-body">
                        <p><strong>E-Mail:</strong> {{ member.email }}</p>
                        {% if member.telefon %}
                        <p><strong>Telefon:</strong> {{ member.telefon }}</p>
                        {% endif %}
                        </div>
                    </div>
                    
                    <!-- Adresse -->
                    {% if member.strasse or member.plz or member.ort %}
                    <div class="member-section">
                        <h4>📍 Adresse</h4>
                        {% if member.strasse %}
                        <p><strong>Straße:</strong> {{ member.strasse }}{% if member.hausnummer %} {{ member.hausnummer }}{% endif %}</p>
                        {% endif %}
                        {% if member.plz or member.ort %}
                        <p><strong>Ort:</strong> {% if member.plz %}{{ member.plz }} {% endif %}{{ member.ort }}</p>
                        {% endif %}
                    </div>
                    {% endif %}
                    
                    <!-- Funktion -->
                    {% if member.funktion or member.beitrittsjahr %}
                    <div class="member-section">
                        <h4>🏢 Funktion</h4>
                        {% if member.funktion %}
                        <p><strong>Position:</strong> {{ member.funktion.value }}</p>
                        {% endif %}
                        {% if member.beitrittsjahr %}
                        <p><strong>Beitritt:</strong> Seit {{ member.beitrittsjahr }}</p>
                        {% endif %}
                    </div>
                    {% endif %}
                    
                    <!-- Körperliche Daten -->
                    {% if member.koerpergroesse or member.koerpergewicht or member.schuhgroesse %}
                    <div class="member-section">
                        <h4>📏 Körperliche Daten</h4>
                        {% if member.koerpergroesse %}
                        <p><strong>Größe:</strong> {{ member.koerpergroesse }} cm</p>
                        {% endif %}
                        {% if member.koerpergewicht %}
                        <p><strong>Gewicht:</strong> {{ member.koerpergewicht }} kg</p>
                        {% endif %}
                        {% if member.schuhgroesse %}
                        <p><strong>Schuhgröße:</strong> {{ member.schuhgroesse }}</p>
                        {% endif %}
                    </div>
                    {% endif %}
                    
                    <!-- Präferenzen -->
                    {% if member.zimmerwunsch or member.spirit_animal or member.fuehrerschein or member.kleider_oberteil or member.kleider_hosen or member.kleider_cap %}
                    <div class="member-section">
                        <h4>⭐ Präferenzen</h4>
                        {% if member.zimmerwunsch %}
                        <p><strong>Zimmerwunsch:</strong> {{ member.zimmerwunsch }}</p>
                        {% endif %}
                        {% if member.spirit_animal %}
                        <p><strong>Spirit Animal:</strong> {{ member.spirit_animal }}</p>
                        {% endif %}
                        {% if member.fuehrerschein %}
                        <p><strong>Führerschein:</strong> {{ member.fuehrerschein }}</p>
                        {% endif %}
                        {% if member.kleider_oberteil or member.kleider_hosen or member.kleider_cap %}
                        <p><strong>Kleidergrößen:</strong>
                            {% if member.kleider_oberteil %}Oberteil: {{ member.kleider_oberteil }}{% endif %}
                            {% if member.kleider_hosen %}{% if member.kleider_oberteil %}, {% endif %}Hosen: {{ member.kleider_hosen }}{% endif %}
                            {% if member.kleider_cap %}{% if member.kleider_oberteil or member.kleider_hosen %}, {% endif %}Cap: {{ member.kleider_cap }}{% endif %}
                        </p>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                
                <!-- Aktionen -->
                <div class="card-actions primary">
                    <a href="{{ url_for('admin.edit_member', member_id=member.id) }}" class="btn btn-primary">✏️ Bearbeiten</a>
                    <a href="{{ url_for('admin.member_sensitive', member_id=member.id) }}" class="btn btn-warning">🔒 Sensible Daten</a>
                    <a href="{{ url_for('admin.member_security_overview', member_id=member.id) }}" class="btn btn-info">🔐 Sicherheit</a>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Statistiken als Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3 class="stat-title">👥 Gesamt</h3>
                <div class="stat-value">{{ members|length }}</div>
                <p class="stat-label">Mitglieder</p>
            </div>
            
            <div class="stat-card">
                <h3 class="stat-title">✅ Aktiv</h3>
                <div class="stat-value">{{ members|selectattr('is_active')|list|length }}</div>
                <p class="stat-label">Aktive Mitglieder</p>
            </div>
            
            <div class="stat-card">
                <h3 class="stat-title">⚙️ Admins</h3>
                <div class="stat-value">{{ members|selectattr('role.value', 'equalto', 'ADMIN')|list|length }}</div>
                <p class="stat-label">Admin-Benutzer</p>
            </div>
            
            <div class="stat-card">
                <h3 class="stat-title">🏆 Vorstand</h3>
                <div class="stat-value">{{ members|selectattr('vorstandsmitglied')|list|length }}</div>
                <p class="stat-label">Vorstandsmitglieder</p>
            </div>
        </div>
    </div>
</div>
{% endblock %} 